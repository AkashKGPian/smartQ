<!DOCTYPE html>
<html>
<head>
  <title>Staff Dashboard | SmartQ</title>
</head>
<body>
  <h1>ğŸ¥ Staff Dashboard</h1>
  <a href="/api/auth/staff/logout">ğŸšª Logout</a>

  <% queues.forEach(item => { %>
    <hr />
    <h3>
      <%= item.queue.type %> Queue
      <% if (item.queue.isPaused) { %>
        (Paused)
      <% } %>
    </h3>

    <p>Waiting: <%= item.waitingCount %></p>

    <% if (item.currentToken) { %>
      <p>
        Currently Serving:
        <strong>Token <%= item.currentToken.number %></strong>
      </p>

      <!-- Mark as Served -->
      <form method="post" action="/api/token/<%= item.currentToken._id %>/complete" style="display:inline">
        <input type="hidden" name="status" value="SERVED" />
        <button>âœ… Mark Served</button>
      </form>

      <!-- Mark as Missed -->
      <form method="post" action="/api/token/<%= item.currentToken._id %>/complete" style="display:inline">
        <input type="hidden" name="status" value="MISSED" />
        <button>âŒ Mark Missed</button>
      </form>
    <% } else { %>
      <p>No token currently called</p>
    <% } %>

    <form method="post" action="/api/token/call-next">
      <input type="hidden" name="queueId" value="<%= item.queue._id %>" />
      <button>ğŸ“¢ Call Next</button>
    </form>

    <% if (item.queue.isPaused) { %>
      <form method="post" action="/api/staff/queue/<%= item.queue._id %>/resume">
        <button>â–¶ï¸ Resume Queue</button>
      </form>
    <% } else { %>
      <form method="post" action="/api/staff/queue/<%= item.queue._id %>/pause">
        <button>â¸ï¸ Pause Queue</button>
      </form>
    <% } %>
  <% }) %>
</body>
</html>
